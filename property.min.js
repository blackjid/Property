Subscription=function(a,b,c,d){this._target=a;this._eventType=b;this._listener=c;this._context=d;this._active=!0};Subscription.prototype.cancel=function(){if(this._active)this._target.unbind(this._eventType,this._listener,this._context),this._active=!1};
Observable={bind:function(a,b,c){this._listeners=this._listeners||{};(this._listeners[a]=this._listeners[a]||[]).push([b,c]);return new Subscription(this,a,b,c)},trigger:function(a){if(this._listeners){var b=this._listeners[a];if(b){var c=arguments;_.each(b,function(a){a[0].apply(a[1],_.rest(c))})}}},unbind:function(a,b,c){if(this._listeners&&(a=this._listeners[a]))for(var d=a.length;d--;)a[d][0]===b&&a[d][1]===c&&a.splice(d,1)}};function property(a){this.value=a;$.extend(this,Observable)}
property.prototype.__onChange__=function(a,b){this.bind("change",a,b);a.call(b,this.value);return this};property.prototype.set=function(a){var b=this.value;if(this.value!=a)this.value=a,this.trigger("change",a,b)};property.prototype.is=function(a){return this.value==a};property.prototype.bindClass=function(a,b,c){return this.__onChange__(function(d){var e=_.isFunction(b)?b:function(a){return b==a};$(a).toggleClass(c,e(d))})};
property.prototype.toggleAttr=function(a,b){var c=this;$(a).change(function(){c.set($(this).attr(b))});return this.__onChange__(function(c){c?$(a).attr(b,!0):$(a).removeAttr(b)})};property.prototype.toggleClass=function(a,b){return this.__onChange__(function(c){$(a).toggleClass(b+"-on",c);$(a).toggleClass(b+"-off",!c)})};property.prototype.prefixClass=function(a,b){return this.__onChange__(function(c,d){$(a).toggleClass(b+"-"+d,!1);$(a).toggleClass(b+"-"+c,!0)})};
property.prototype.change=function(a,b){this.bind("change",a,b);return this};property.prototype.when=function(a,b,c){this.bind("change",function(d){_.isFunction(a)?a(d)&&b.call(c):a===d&&b.call(c)},c);return this};property.prototype.toggle=function(){this.set(!this.value)};property.prototype.toggleVisibility=function(a,b){return this.__onChange__(function(c,d){d===b&&$(a).hide();c===b&&$(a).show()})};property.prototype.destruct=function(){};
